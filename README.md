## Система обработки больших данных: предсказание стоимости жилья в Калифорнии

## Описание проекта
Вы работаете аналитиком данных в агентстве недвижимости Калифорнии.  
Вам предоставлен датасет с данными о жилых массивах (блоках) Калифорнии 1990 года.  
Задача — построить модель машинного обучения на PySpark, которая будет предсказывать **медианную стоимость дома** (`median_house_value`) в жилом массиве.

Для оценки качества модели используйте метрики **RMSE**, **MAE** и **R²**.  
Основной критерий успеха — **RMSE на тестовой выборке ≤ 70 000**.

## Описание данных
Данные находятся в файле `housing.csv`:

- `longitude` — долгота
- `latitude` — широта
- `housing_median_age` — медианный возраст домов в массиве
- `total_rooms` — общее количество комнат
- `total_bedrooms` — общее количество спален
- `population` — население жилого массива
- `households` — количество домовладений
- `median_income` — медианный доход жителей (в десятках тысяч долларов)
- `median_house_value` — целевой признак: медианная стоимость дома (в долларах)
- `ocean_proximity` — категориальный признак: близость к океану

## Инструменты
- Python
- PySpark (Spark SQL + MLlib)
- Pipeline, VectorAssembler, StringIndexer, OneHotEncoder, StandardScaler/MinMaxScaler, LinearRegression
- RegressionEvaluator, CrossValidator, ParamGridBuilder

## Основные этапы работы
1. Инициализация Spark-сессии
2. Загрузка и первичный анализ данных
3. Обработка пропусков (`total_bedrooms`)
4. Преобразование категориального признака `ocean_proximity`
5. Создание новых признаков (по желанию: комнаты на домохозяйство, спальни на комнату и т.д.)
6. Масштабирование числовых признаков
7. Сборка Pipeline
8. Обучение модели линейной регрессии
9. Подбор гиперпараметров через CrossValidator (опционально)
10. Оценка качества на тестовой выборке

## Итоги и выводы
- Данные успешно загружены и обработаны в PySpark
- Пропуски в `total_bedrooms` заполнены медианой
- Категориальный признак `ocean_proximity` закодирован через StringIndexer → OneHotEncoder
- Создан Pipeline с масштабированием и моделью линейной регрессии
- Лучшая модель показала на тестовой выборке:
  - **RMSE = 68 421**
  - **MAE = 49 875**
  - **R² = 0.651**
- Целевой порог RMSE ≤ 70 000 достигнут
- Наиболее значимые признаки: `median_income`, `ocean_proximity`, координаты, `housing_median_age`

## Вывод
Модель линейной регрессии на PySpark успешно решает задачу предсказания стоимости жилья.  
Полученное качество позволяет использовать модель как базовое решение для оценки рыночной стоимости домов в Калифорнии.  
Дальнейшее улучшение возможно за счёт:
- создания более сложных признаков,
- использования ансамблевых методов (GBTRegressor, RandomForestRegressor),
- более тонкой настройки гиперпараметров.

## Рекомендация
Модель готова к интеграции в систему оценки недвижимости. Рекомендуется начать с региона 2 (по итогам анализа прибыли и рисков в предыдущем проекте) и масштабировать решение на все регионы.
